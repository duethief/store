<!DOCTYPE html>
<html ng-app>
<head>
    <meta charset="utf-8">
    <title>장바구니</title>
</head>
<body ng-controller="CartController">
    <h1>내 장바구니</h1>
    <div ng-repeat="item in items">
        <span>{{item.title}}</span>
        <input ng-model="item.quantity">
        <span>{{item.price | currency}}</span>
        <span>{{item.price * item.quantity | currency}}</span>
        <button ng-click="remove($index)">삭제</button>
    </div>
    <div>전체 금액: {{bill.totalCart | currency}}</div>
    <div>할인: {{bill.discount | currency}}</div>
    <div>결제 금액: {{bill.subtotal | currency}}</div>
    <script src="../../lib/js/angular.min.js"></script>
    <script>
        function CartController($scope) {
            $scope.bill = {};

            $scope.items = [{
                title : '페인트 그릇',
                quantity : 8,
                price : 3.95
            }, {
                title : '땡땡이 리본',
                quantity : 17,
                price : 12.95
            }, {
                title : '공깃돌',
                quantity : 5,
                price : 6.95
            }];

            $scope.remove = function(index) {
                $scope.items.splice(index, 1);
            };

            $scope.$watch("items", function (newValue, oldValue, scope) {
                var total = 0;
                for (var i in $scope.items) {
                    total = total + $scope.items[i].price * $scope.items[i].quantity;
                }
                $scope.bill.totalCart = total;
                $scope.bill.discount = total > 100 ? 10 : 0;
                $scope.bill.subtotal = total  - $scope.bill.discount;
            }, true);
        }
    </script>
</body>
</html>